<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penguin üêß Crypto Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .crypto-card:hover { transform: translateY(-2px); transition: all 0.2s; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 10px; }
    </style>
</head>
<body class="bg-gray-900 text-white font-sans">

    <nav class="border-b border-gray-800 p-4 flex justify-between items-center bg-gray-900 sticky top-0 z-50">
        <h1 class="text-2xl font-bold text-blue-400">üêß PENGUIN</h1>
        <div class="relative w-64">
            <input type="text" id="searchInput" placeholder="Search (e.g. BTC)..." 
                class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500">
        </div>
    </nav>

    <div class="container mx-auto p-4">
        <div class="flex gap-4 mb-6 overflow-x-auto pb-2">
            <button onclick="fetchMarketData('gainers')" class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded-full font-semibold whitespace-nowrap">üî• Top Gainers</button>
            <button onclick="fetchMarketData('losers')" class="bg-red-600 hover:bg-red-700 px-6 py-2 rounded-full font-semibold whitespace-nowrap">üìâ Top Losers</button>
            <button onclick="fetchMarketData('trending')" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-full font-semibold whitespace-nowrap">‚≠ê Trending</button>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-1 bg-gray-800 rounded-xl p-4 h-[600px] overflow-y-auto" id="tickerList">
                <p class="text-gray-400 animate-pulse">Loading market data...</p>
            </div>

            <div class="lg:col-span-2 bg-gray-800 rounded-xl p-4 h-[600px] flex flex-col">
                <div id="chartHeader" class="mb-4 flex justify-between items-center">
                    <h2 id="activeSymbol" class="text-xl font-bold">BTC/USDT</h2>
                </div>
                <div id="tradingview_widget" class="flex-grow"></div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        let currentSymbol = "BTCUSDT";

        // Initialize Chart
        function loadChart(symbol) {
            currentSymbol = symbol;
            document.getElementById('activeSymbol').innerText = symbol.replace("USDT", "/USDT");
            new TradingView.widget({
                "autosize": true,
                "symbol": "BINANCE:" + symbol,
                "interval": "D",
                "timezone": "Etc/UTC",
                "theme": "dark",
                "style": "1",
                "locale": "en",
                "toolbar_bg": "#f1f3f6",
                "enable_publishing": false,
                "hide_top_toolbar": false,
                "save_image": false,
                "container_id": "tradingview_widget"
            });
        }

        // Fetch Data from Binance API
        async function fetchMarketData(type) {
            const listContainer = document.getElementById('tickerList');
            listContainer.innerHTML = '<p class="text-gray-400 animate-pulse">Updating...</p>';
            
            try {
                const response = await fetch('https://api.binance.com/api/v3/ticker/24hr');
                const data = await response.json();
                
                // Filter for USDT pairs only
                let filtered = data.filter(item => item.symbol.endsWith('USDT'));

                if(type === 'gainers') {
                    filtered.sort((a, b) => b.priceChangePercent - a.priceChangePercent);
                } else if(type === 'losers') {
                    filtered.sort((a, b) => a.priceChangePercent - b.priceChangePercent);
                } else {
                    // Trending (Sorting by Volume for this example)
                    filtered.sort((a, b) => b.quoteVolume - a.quoteVolume);
                }

                listContainer.innerHTML = '';
                filtered.slice(0, 50).forEach(coin => {
                    const isPositive = coin.priceChangePercent >= 0;
                    const card = document.createElement('div');
                    card.className = "flex justify-between items-center p-3 mb-2 bg-gray-700 rounded-lg cursor-pointer crypto-card";
                    card.onclick = () => loadChart(coin.symbol);
                    card.innerHTML = `
                        <div>
                            <div class="font-bold">${coin.symbol.replace('USDT', '')}</div>
                            <div class="text-xs text-gray-400">Vol: ${parseFloat(coin.quoteVolume).toLocaleString()}</div>
                        </div>
                        <div class="text-right">
                            <div class="font-mono">$${parseFloat(coin.lastPrice).toFixed(2)}</div>
                            <div class="${isPositive ? 'text-green-400' : 'text-red-400'} text-sm">
                                ${isPositive ? '‚ñ≤' : '‚ñº'} ${coin.priceChangePercent}%
                            </div>
                        </div>
                    `;
                    listContainer.appendChild(card);
                });
            } catch (error) {
                listContainer.innerHTML = '<p class="text-red-400">Error loading data. Try again.</p>';
            }
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const val = e.target.value.toUpperCase();
            const cards = document.querySelectorAll('.crypto-card');
            cards.forEach(card => {
                const symbol = card.querySelector('.font-bold').innerText;
                card.style.display = symbol.includes(val) ? 'flex' : 'none';
            });
        });

        // Initial Load
        loadChart('BTCUSDT');
        fetchMarketData('trending');
    </script>
</body>
</html>
